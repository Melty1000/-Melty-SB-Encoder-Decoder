<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Streamer.bot Export Tool</title>
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="styles.css">

    <!-- Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pako/2.1.0/pako.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vanilla-tilt/1.8.0/vanilla-tilt.min.js"></script>

    <!-- Icons & Fonts -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Consolas&display=swap"
        rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
</head>

<body>
    <!-- Particle Background -->
    <canvas id="particles-canvas"></canvas>

    <!-- Drag & Drop Overlay -->
    <div id="drop-overlay" class="hidden">
        <div class="drop-content">
            <i class="fa-solid fa-cloud-arrow-up"></i>
            <h2>Drop File Here</h2>
        </div>
    </div>

    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="brand">
                <h1>SB TOOL</h1>
                <span class="version">v3.0 Extreme</span>
            </div>

            <nav class="nav-menu">
                <button class="nav-btn active" data-target="decoder">
                    <i class="fa-solid fa-folder-open"></i> Decoder
                </button>
                <button class="nav-btn" data-target="encoder">
                    <i class="fa-solid fa-box-archive"></i> Encoder
                </button>
                <button class="nav-btn" data-target="support">
                    <i class="fa-solid fa-heart"></i> Support Me
                </button>
                <button class="nav-btn" data-target="help">
                    <i class="fa-solid fa-circle-question"></i> Help Guide
                </button>
            </nav>

            <!-- Theme Picker -->
            <div class="theme-picker">
                <p>Theme</p>
                <div class="theme-options">
                    <button class="theme-btn active" data-theme="orange" style="background: #ffaa00;"></button>
                    <button class="theme-btn" data-theme="blue" style="background: #00aaff;"></button>
                    <button class="theme-btn" data-theme="purple" style="background: #aa00ff;"></button>
                    <button class="theme-btn" data-theme="green" style="background: #00ffaa;"></button>
                </div>
            </div>

            <!-- History -->
            <div class="history-section">
                <p>Recent Exports</p>
                <ul id="history-list">
                    <!-- History items -->
                </ul>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="content">
            <!-- DECODER PAGE -->
            <section id="decoder" class="page active">
                <header class="page-header">
                    <h2>Decoder</h2>
                    <p>Extract, Edit, and Re-Encode C# scripts.</p>
                </header>

                <div class="card input-card" data-tilt data-tilt-max="2" data-tilt-speed="400" data-tilt-glare
                    data-tilt-max-glare="0.1">
                    <div class="toolbar">
                        <div class="file-input-wrapper">
                            <button class="btn secondary" id="btn-open-file">
                                <i class="fa-solid fa-file-import"></i> Open File
                            </button>
                            <input type="file" id="file-upload-decoder" accept=".txt" hidden>
                        </div>
                        <button class="btn primary" id="btn-decode">
                            <i class="fa-solid fa-play"></i> DECODE
                        </button>
                    </div>
                    <textarea id="decoder-input" placeholder="Paste export string here..."></textarea>
                </div>

                <!-- Stats Dashboard -->
                <div class="stats-grid hidden" id="stats-dashboard">
                    <div class="stat-card">
                        <i class="fa-solid fa-bolt"></i>
                        <span id="stat-actions">0</span>
                        <label>Actions</label>
                    </div>
                    <div class="stat-card">
                        <i class="fa-solid fa-code"></i>
                        <span id="stat-scripts">0</span>
                        <label>Scripts</label>
                    </div>
                    <div class="stat-card">
                        <i class="fa-solid fa-fingerprint"></i>
                        <span id="stat-triggers">0</span>
                        <label>Triggers</label>
                    </div>
                </div>

                <div class="card output-card hidden" id="decoder-output-area">
                    <div class="tabs">
                        <button class="tab-btn active" data-tab="scripts">C# Scripts</button>
                        <button class="tab-btn" data-tab="json">JSON Data</button>
                    </div>

                    <div class="tab-content active" id="tab-scripts">
                        <div class="split-view">
                            <div class="list-pane">
                                <div class="search-box">
                                    <i class="fa-solid fa-magnifying-glass"></i>
                                    <input type="text" id="script-search" placeholder="Search scripts...">
                                </div>
                                <ul id="script-list">
                                    <!-- Scripts will be listed here -->
                                </ul>
                                <div class="list-actions">
                                    <button class="btn secondary full-width" id="btn-download-zip">
                                        <i class="fa-solid fa-file-zipper"></i> Download ZIP
                                    </button>
                                </div>
                            </div>
                            <div class="code-pane">
                                <div class="pane-header">
                                    <span>Code Editor</span>
                                    <div class="pane-actions">
                                        <button class="btn small primary" id="btn-re-encode">
                                            <i class="fa-solid fa-rotate"></i> Re-Encode
                                        </button>
                                        <button class="btn small secondary" id="btn-copy-code">Copy</button>
                                    </div>
                                </div>
                                <div class="editor-wrapper">
                                    <textarea id="code-editor" spellcheck="false"></textarea>
                                    <pre><code id="code-preview" class="language-csharp"></code></pre>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="tab-content" id="tab-json">
                        <div class="pane-header">
                            <span>JSON Structure</span>
                            <button class="btn small secondary" id="btn-copy-json">Copy JSON</button>
                        </div>
                        <pre><code id="json-preview" class="language-json"></code></pre>
                    </div>
                </div>
            </section>

            <!-- ENCODER PAGE -->
            <section id="encoder" class="page">
                <header class="page-header">
                    <h2>Encoder</h2>
                    <p>Create import strings by injecting C# files into a JSON template.</p>
                </header>

                <div class="card" data-tilt data-tilt-max="2" data-tilt-speed="400">
                    <div class="step" style="margin-bottom: 30px;">
                        <h3 style="color: var(--accent); margin-bottom: 10px;">1. Base JSON Template</h3>
                        <p style="color: var(--text-sub); margin-bottom: 15px; font-size: 14px;">Select the JSON file
                            defining your actions. Use <code>"byteCode": "filename.cs"</code> placeholders.</p>
                        <div class="file-row" style="display: flex; gap: 10px;">
                            <input type="text" id="encoder-json-path" placeholder="No file selected" readonly>
                            <button class="btn secondary" id="btn-browse-json">Browse</button>
                            <input type="file" id="file-upload-json" accept=".json" hidden>
                        </div>
                    </div>

                    <div class="step" style="margin-bottom: 30px;">
                        <h3 style="color: var(--accent); margin-bottom: 10px;">2. Scripts</h3>
                        <p style="color: var(--text-sub); margin-bottom: 15px; font-size: 14px;">Select the .cs files
                            referenced in your JSON.</p>
                        <div class="file-row" style="display: flex; gap: 10px;">
                            <input type="text" id="encoder-scripts-count" placeholder="No files selected" readonly>
                            <button class="btn secondary" id="btn-browse-scripts">Browse</button>
                            <input type="file" id="file-upload-scripts" accept=".cs" multiple hidden>
                        </div>
                    </div>

                    <button class="btn primary full-width" id="btn-encode">
                        <i class="fa-solid fa-bolt"></i> GENERATE IMPORT STRING
                    </button>
                </div>

                <div class="card output-card hidden" id="encoder-output-area">
                    <div class="pane-header" style="background: transparent; padding: 0 0 15px 0; border: none;">
                        <h3 style="color: var(--text-main);">Output</h3>
                        <button class="btn secondary" id="btn-copy-encoded">Copy Output</button>
                        </header>
                        <div class="card" data-tilt>
                            <div class="help-section" style="margin-bottom: 30px;">
                                <h3 style="color: var(--accent); margin-bottom: 10px;">Decoding an Export</h3>
                                <p style="color: var(--text-sub); line-height: 1.6;">1. Go to the 'Decoder' tab.<br>
                                    2. Click 'Open File' or paste the export string.<br>
                                    3. Click 'DECODE'.<br>
                                    4. Browse extracted scripts and copy them.</p>
                            </div>
                            <div class="help-section">
                                <h3 style="color: var(--accent); margin-bottom: 10px;">Creating an Export (Encoder)</h3>
                                <p style="color: var(--text-sub); line-height: 1.6;">1. Create a 'Base JSON' file.<br>
                                    2. Use <code>"byteCode": "MyScript.cs"</code> in your JSON.<br>
                                    3. Upload the JSON and the referenced .cs files.<br>
                                    4. Click 'GENERATE'.</p>
                            </div>
                        </div>
            </section>
        </main>

        <!-- Toast Container -->
        <div id="toast-container"></div>
    </div>

    <!-- Prism JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-csharp.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-json.min.js"></script>

    <script src="app.js"></script>
</body>

</html>